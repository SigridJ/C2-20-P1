\section{Løsningsalgoritmer}

For at finde en $k$-approksimation der løser et tilfælde af TSP, viser det sig at problemet da nødvendigvis skal restringeres til eksempelvis den metriske version.
Selvom der ikke findes nogen nem løsning til TSP, er det dog stadig muligt at finde på en løsningsalgoritme.

Den mest umiddelbare løsningsalgoritme til at finde en kortest mulig Hamiltonkreds rundt i en graf, finder samtlige mulige Hamiltonkredse i grafen. Til hver af disse kredse beregnes den samlede vægt, og til sidst sammenlignes alle disse samlede vægte, for at finde den Hamiltonkreds, som har den mindste samlede vægt. Denne algoritme er i pseudokode beskrevet i Algoritme \ref{brute_force}.

\begin{algorithm}
\caption{Brute-force algoritmen}
\label{brute_force}
\textbf{procedure} Find korteste Hamiltonkreds i grafen $G$.

Bestem alle Hamiltonkredse, $H_k$, i $G$, og lad $H_{ki}$ betegne den $i$'te Hamiltonkreds. \\
	$min := d(H_{k1})$ \\
	$\alpha :=$ antallet af hamiltonkrede \\
\textbf{for} $i:=2$ til $\alpha$ \\
$\-$ $\-$ $\-$ $\-$ $\-$ $\-$
	\textbf{hvis} $min > d(H_{ki})$ \textbf{så} $min := d(H_{ki})$ \\
\textbf{returnér} $min$ $\lbrace$ $min$ er den korteste Hamiltonkreds i $G$ $\rbrace$
\end{algorithm}

Denne algoritme vil altid finde den kortest mulige Hamiltonkreds i en komplet graf $G$, men kræver meget tid at gennemføre, selv for grafer med relativt få knuder \citep{dmat}.

\begin{thm}
	Den værst mulige tidskompleksitet af Brute-force Algoritmen er $\Theta((n-1)!)$.
\end{thm}

\begin{proof}
	Lad $G$ være en komplet graf med $n$ knuder og $n \geq 3$.
	I denne graf er der så $(n-1)!$ forskellige Hamiltonkredse, idet de $n-1$ punkter kan arrangeres på $(n-1)!$ forskellige måder.
	Antallet af sammenligninger i Algoritme \ref{brute_force} er det samme som antallet af gentagelser i for-løkken.
	Dette er det samme om antallet af hamiltonkredse minus 1, og da må antallet af sammenligninger være $(n-1)! -1$.  	

	Det vises nu at $(n-1)! -1$ er $\Theta((n-1)!)$.

	Lad antallet af sammenligninger $f(n) = (n-1)! -1$, og lad $n > 2$.
	Da må $f(n)$ være $O((n-1)!)$, siden
	\begin{align*}
		(n-1)! -1 \leq (n-1)!
	\end{align*}
	når $n>2$. Da er vidnerne $k=2$ og $C=1$.
	
	Funktionen $f(n)$ må også være $\Omega((n-1)!)$, da
	\begin{align*}
		(n-1)! -1 \geq (n-1)! - \frac{(n-1)!}{2} = \frac{(n-1)!}{2}
	\end{align*}
	når $n>2$. Da er vidnerne $k=2$ og $C=\frac{1}{2}$.

	Eftersom $f(n)$ både er $O((n-1)!)$ og $\Omega((n-1)!)$ må $f(n)$ også være $\Theta((n-1)!)$. Da er tidskompleksiteten af Brute-force algortimen $\Theta((n-1)!)$.
\end{proof}

Brute-force algoritmen har således en kompleksitet, der er voldsom stor selv ved relativt få knuder i $G$.

\begin{exmp}
I den komplet graf, $G$, med $20$ knuder, har brute-force algoritmen en værst mulig tidskompleksitet på $$19! = 121645100408832000,$$ hvorfor algoritmen tydeligvis allerede ved $20$ knuder er håbløs, da det er svært at forestille sig en computer der hurtigt kan udregne dette antal sammenligninger.
\end{exmp}

Derfor er approksimationsalgoritmer nødvendige, for at løse problemet. Som tidligere beskrevet, vil disse algoritmer \textit{ikke} finde den optimale løsning, men en løsning, som ligger indenfor en vis konstant grænse. I denne rapport vil Dobbelttræ-algoritmen anvendes til at løse TSP. 

\subsection{Dobbelttræ-algoritmen}
Dobbelttræ-algoritmen forudsætter, at grafen, som Hamiltonkredsen skal findes i, er komplet metrisk. For sådanne grafer kan der imidlertid foretages en \textit{genvej}, som defineres i Definition \ref{def_genvej}.

\begin{defn}
Lad $G$ være en komplet, metrisk graf med $n$ knuder og $n \geq 3$. I $G$ findes en vej, $P = v_0, v_1,...,v_{i-1}, v_i, v_{i+1},...,v_{n-1},v_n$ hvor $1 \leq i \leq n-1$.

	Da kan der dannes en \textit{genvej} i $P$ via $e=\lbrace v_{i-1}, v_{i+1} \rbrace$, udenom $v_i$, så en ny vej, $P'=v_0, v_1,...,v_{i-1},v_{i+1},...,v_{n+1},v_n$, dannes. Her er $\lbrace v_i \rbrace = P \setminus P'$.
\label{def_genvej}
\end{defn}

Det gælder desuden for en genvej i en vej, $P$, udenom knuden $v_i$, hvor $v_{i-1}$ og $v_{i+1}$ var dets naboer i vejen, at den nye vej, $P'$ er kortere end den forrige, da grafen er metrisk og opfylder den trekantsuligheden.
Siden $d(v_{i-1},v_{i+1}) \leq d(v_{i-1}, v_i) + d(v_i, v_{i+1})$ må $d(P') \leq d(P)$. 

I en komplet, metrisk graf $G$ begynder Dobbelttræ-algoritmen med, at finde et minimalt udspændende træ, $T$, ved hjælp af Prims Algoritme.
Når $T$ er fundet, fordobles alle kanter i $T$, som så danner en multigraf $D$.
Graden af alle knuder i $D$ må være lige, hvorfor der må eksistere en Eulerkreds i $D$, jf. Sætning \ref{Eulerkreds_multigraf}.
Eulerkredsen dannes ved Algoritme \ref{algoritme_euler}.
I denne Eulerkreds skydes der genvej udenom en knude, hvis knuden allerede er med i kredsen, for at opnå en Hamiltonkreds, $H$.
Denne algoritme er sammenfattet i Algoritme \ref{dt_algo}.

\begin{algorithm}[h]
\caption{Dobbelttræ-algoritme}
\label{dt_algo}
\textbf{procedure} En metrisk komplet graf, $G$ \\
Find minimalt udspændende træ, $T$, i $G$ $\lbrace$ Prims Algoritme $\rbrace$. \\
$D := T$ \\
\textbf{for} kant \textbf{i} $D$ \\
$\-$ $\-$ $\-$ $\-$ $\-$ $\-$
dublér kant \\
Find Eulerkreds, $E$, i $D$ \\
Skyd genvej i $E$ for at opnå Hamiltonkredsen, $H$ \\
\textbf{returnér} $H$ $\lbrace$ $H$ er Hamiltonkreds i $G$ $\rbrace$
\end{algorithm}

\begin{exmp}
	Som eksempel på Dobbelttræ-Algoritmens fremgangsmåde, ses på en komplet, metrisk graf med $5$ knuder.
På Figur \ref{dtex1} ses grafen, som der nu skal findes en Hamiltonkreds i.
	Algoritmen finder så er minimalt udspændende træ ved Prims algoritme som i Figur \ref{dtex2}.
	Herefter ses bort fra de resterende kanter, som ikke er en del af træet, og samtlige kanter i det minimalt udspændende træ fordobles, som det er gjort i Figur \ref{dtex3}.
	Slutteligt skydes der flere genveje, som på Figur \ref{dtex4} ses som den røde kant, som indsættes til fordel for de stiplede kanter. Dermed er der fundet en Hamiltonkreds.

\begin{figure}[h]
\centering
	\begin{subfigure}{0.5\textwidth}
		\centering
			\scalebox{0.7}{\input{incl/main/double_tree_ex}}
		\label{dtex1}
		\caption{Komplet vægtet metrisk graf med $5$ knuder.}
	\end{subfigure}%
	\begin{subfigure}{0.5\textwidth}
		\centering
			\scalebox{0.7}{\input{incl/main/double_tree_ex2}}
		\label{dtex2}
		\caption{Minimalt undspændende træ findes i grafen.}
	\end{subfigure}
	\newline
	\begin{subfigure}{0.5\textwidth}
		\centering		
			\scalebox{0.7}{\input{incl/main/double_tree_ex3}}
		\label{dtex3}
		\caption{Alle kanter i træet fordobles.}
	\end{subfigure}%
	\begin{subfigure}{0.5\textwidth}
		\centering
			\scalebox{0.7}{\input{incl/main/double_tree_ex4}}
		\label{dtex4}
		\caption{Der skydes genvej i Eulerkredsen\\ for at
		danne en Hamiltonkreds.}
	\end{subfigure}
\end{figure}
\end{exmp}

Dobbelttræ-algoritmen finder en Hamiltonkreds som er en approksimation af den optimale løsning til det metriske TSP.

\begin{thm}
Dobbelttræ-algoritmen er en 2-approksimationsalgoritme.
\end{thm}

\begin{proof}
Lad $H$ være Hamiltonkredsen af lavest muligt vægt i grafen $G$ og $H'$ være den Hamiltonkreds, som Dobbelttræ-algoritmen finder ved genvej i Eulerkredsen $E$. Da må der gælde, at 
\begin{align*}
	d(H')\leq d(E).
\end{align*}
Idet Eulerkredsen, $E$, er dannet ved at dublere alle kanter i det minimalt udspændende træ, $T$, må der gælde, at 
\begin{align*}
	d(E) = 2d(T).
\end{align*}
Eftersom enhver Hamiltonkreds ved fjernelse af en kant danner et udspændende træ, må der gælde, at $d(T) \leq d(H)$.
	Heraf følger det, at
	\begin{align*}
		2d(T) \leq 2d(H').
	\end{align*}
Derfor må der gælde, at 
	\begin{align*}
		d(H') \leq 2d(H),
	\end{align*}
	hvorfor Dobbeltræ-algoritmen er en $2$-approksimation.
\end{proof}

\subsection{Kompleksitet af Dobbelttræ-algoritmen}
Dobbelttræ-algoritmen er en approksimationsalgoritme, som det er bevist ovenfor. Derfor må det formodes, at den har en lavere kompleksitet end Brute-force Algoritmen havde.

\begin{thm}
Dobbelttræ-algoritmen har en værst mulig tidskomplesitet på $O(n^3)$.
\end{thm}

\begin{proof}
Dobbelttræ-algoritmen kører først Prims Algoritme, som er $O(n^3)$, jf. Sætning \ref{prim_kompl}. 
Derefter fordobler algoritmen samtlige kanter i træet, som Prims Algoritme har dannet.
	Denne tilfører kompleksiteten $O(n)$.
	Så kører Dobbelttræ-algoritmen algoritmen for dannelsen af en Eulerkreds, som har lineær værst mulig tidskompleksitet, altså også $O(n)$ jf. Sætning \ref{thm:O_euler}.
Slutteligt vil Dobbelttræ-algoritmen skyde genvej hver gang den møder en knude der allerede er med i kredsen, og da danne en Hamiltonkreds. Antallet af sammenligninger der skal fortages for ved hver knude at beslutte om der skal skydes en genvej, må være det samme antal som der er kanter i det fordoblede træ, altså $2n$.
	Da må denne del af algoritmen have tidskompleksiteten $O(n)$.

	Derfor må den værst mulige tidskompleksitet af Dobbelttræ-algoritmen være $O(n^3)$.
\end{proof}

Dobbelttræ-algoritmen viser sig altså at være af polynomiel værst mulig tidskompleksitet, hvorfor denne noget hurtigere vil finde en kort Hamiltonkreds i grafen. Dog er det på kompromis at, at det ikke nødvendigvis er den korteste Hamiltonkreds i $G$.

\begin{exmp}
I den komplette graf, $G$, med $20$ knuder, har Dobbelttræ-algoritmen en værst mulig tidskompleksitet på $$20^3 = 8000,$$ og er derfor markant hurtigere end Brute-force Algoritmen.
\end{exmp}
